export const socketlessjs = atob("LyoqCiAqIFRoaXMgZmlsZSBob3VzZXMgdGhlIGNvcmUgb2YgdGhlIFJQQyBmdW5jdGlvbmFsaXR5LgogKgogKiBUaGUgYFVwZ3JhZGVkU29ja2V0YCBjbGFzcyBpcyBhbiBleHRlbnNpb24gb24gdGhlIFdlYlNvY2tldCBjbGFzcyB0aGF0IGFkZHMKICogY3VzdG9tIG9uL29mZi9zZW5kIG1ldGhvZHMgKGV4cG9zZWQgdGhyb3VnaCBhIHNvY2tldC51cGdyYWRlZCBvYmplY3QpLCBzZXQKICogdXAgdG8gaGFuZGxlIGF1dG9tYXRpYyByZXNwb25zZXMgdG8gY2FsbHMuIEluY29taW5nIFdlYlNvY2tldCBtZXNzYWdlcyBhcmUKICogcm91dGVkIGludG8gdGhlIGByb3V0ZXJgIGZ1bmN0aW9uLCB3aGljaCBoYXMgYmVoYXZpb3VyIHRhaWxvcmVkIHRvIHNwZWNpZmljCiAqIG9yaWdpbnMsIGFuZCBtYWtlcyBzdXJlIHRoYXQgbWVzc2FnZXMgYXJlIGFsd2F5cyByZXNwb25kZWQgdG8uCiAqCiAqIFRoZSBgX19zZW5kYCBmdW5jdGlvbiwgaW4gdHVybiwgZG9lc24ndCBqdXN0IHNlbmQgZGF0YSBvdmVyIHRvIGEgcmVtb3RlLCBidXQKICogYWxzbyB3YWl0cyBmb3IgdGhhdCByZW1vdGUncyA6cmVzcG9uc2UgbWVzc2FnZSwgdXNpbmcgUHJvbWlzZXMgdG8gbWFrZQogKiBzdXJlIHRoYXQgYW55b25lIGNhbiBgYXdhaXQgc29ja2V0LnVwZ3JhZGVkLnNlbmQoLi4uKWAgYW5kIGdldCBhIHJlc3BvbnNlCiAqIG9uY2UgdGhhdCByZXNwb25zZSBoYXMgYmVlbiBzZW50IGJhY2suIEFzIGZhciBhcyBjYWxsaW5nIGNvZGUgaXMgY29uY2VybmVkLAogKiB0aGlzIGlzIGEgbm9ybWFsIGFzeW5jIGNhbGwsIGFuZCB0aGUgZmFjdCB0aGF0IG5ldHdvcmsgdHJhbnNwb3J0IGhhcHBlbmVkCiAqIGlzIGVudGlyZWx5IGlycmVsZXZhbnQuIENhbGxlcnMgc2hvdWxkIG5vdCBjYXJlLgogKgogKiBUaGUgYFNvY2tldFByb3h5YCBpcyBhIGNsZXZlciBsaXR0bGUgUHJveHkgb2JqZWN0IHRoYXQgZXh0ZW5kcyB0aGUgRnVuY3Rpb24KICogYnVpbHQtaW4sIHdoaWNoIGFsbG93cyB1cyB0byBjcmVhdGUgYSByZWN1cnNpdmUgb2JqZWN0IHdoZXJlIGFueSBwcm9wZXJ0eQogKiBvbiBpdCBpcyBhIHZhbGlkIGZ1bmN0aW9uIHRvIGNhbGwsIGFuZCBkb2luZyBzbyB3aWxsIHNlbmQgdGhlIGNvcnJlc3BvbmRpbmcKICogY2FsbCBjaGFpbiBvdmVyIHRvIHRoZSByZW1vdGUgZm9yIGV4ZWN1dGlvbiBhbmQgcmVzcG9uc2UgbWVzc2FnaW5nLiBUaGlzIHdheSwKICogd2UgZG9uJ3QgbmVlZCB0byBwZXJmb3JtIGFueSAid2hpY2ggZnVuY3Rpb25zIGFyZSBzdXBwb3J0ZWQiLCB3ZSBjYW4ganVzdCBwcm94eQogKiB0aGUgY2FsbCBvdmVyIHRoZSBuZXR3b3JrLCBpZiBpdCBleGlzdHMsIGl0IHJ1bnMsIGlmIGl0IGRvZXNuJ3QsIHRoZW4gd2UnbGwKICogZ2V0IGEgcmVzdWx0IGJhY2sgd2l0aCBhbiBgZXJyb3JgIG1lc3NhZ2UgdGhhdCB3ZSBjYW4gdHVybiBpbnRvIGEgbG9jYWwgdGhyb3cuCiAqLwoKCmNvbnN0IEJST1dTRVIgPSAiYnJvd3NlciI7CmNvbnN0IENMSUVOVCA9ICJjbGllbnQiOwoKY2xhc3MgUlBDRXJyb3IgewogIGNvbnN0cnVjdG9yKG9yaWdpbk5hbWUsIG1lc3NhZ2UpIHsKICAgIHRoaXMub3JpZ2luTmFtZSA9IG9yaWdpbk5hbWU7CiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlOwogIH0KfQoKY29uc3QgREVCVUcgPSBmYWxzZTsKCi8vIGltcG9ydGluZyB0aGUgdXVpZCBwYWNrYWdlIGlzIHdheSB0b28gZXhwZW5zaXZlIGZvciB3aGF0IHdlIG5lZWQgaGVyZQpmdW5jdGlvbiB1dWlkKCkgewogIGNvbnN0IG5vdyA9IERhdGUubm93KCkudG9TdHJpbmcoMTYpOwogIGNvbnN0IHJkbSA9ICgoMWU2ICogTWF0aC5yYW5kb20oKSkgfCAwKS50b1N0cmluZygxNik7CiAgcmV0dXJuIGAke25vd30tJHtyZG19YDsKfQoKLy8gcmVzcG9uc2VzIHNob3VsZCBhbHdheXMgYmUgInRoZSBldmVudCBuYW1lLCB3aXRoIDpyZXNwb25zZSBhZGRlZCIKZXhwb3J0IGNvbnN0IFJFU1BPTlNFX1NVRkZJWCA9IGA6cmVzcG9uc2VgOwpleHBvcnQgY29uc3QgZ2V0UmVzcG9uc2VOYW1lID0gKGV2ZW50TmFtZSkgPT4gYCR7ZXZlbnROYW1lfSR7UkVTUE9OU0VfU1VGRklYfWA7CgovLyB1c2Ugc3ltYm9scyBzbyB3ZSBkb24ndCBwb2xsdXRlIHRoZSBzb2NrZXQgcHJvdG90eXBlCmNvbnN0IE9SSUdJTiA9IFN5bWJvbChgb3JpZ2luYCk7CmNvbnN0IFBST1hZID0gU3ltYm9sKGBwcm94eWApOwpjb25zdCBSRUNFSVZFUiA9IFN5bWJvbChgcmVjZWl2ZXJgKTsKY29uc3QgUkVNT1RFID0gU3ltYm9sKGByZW1vdGVgKTsKY29uc3QgSEFORExFUlMgPSBTeW1ib2woYGhhbmRsZXJzYCk7CgovKioKICogLi4uZG8gZG9jcyBnbyBoZXJlPwogKi8KY2xhc3MgVXBncmFkZWRTb2NrZXQgZXh0ZW5kcyBXZWJTb2NrZXQgewogIFtPUklHSU5dID0gdW5kZWZpbmVkOyAvLyB0aGUgc29ja2V0IG93bmVyIHdobyBpbnZva2VkIHRoZSB1cGdyYWRlLiBTZWUgdXBncmFkZSgpCiAgW1BST1hZXSA9IHVuZGVmaW5lZDsgLy8gdGhlIHByb3h5IG9iamVjdCBhc3NvY2lhdGVkIHdpdGggdGhpcyBzb2NrZXQKICBbUkVDRUlWRVJdID0gYGA7IC8vIG5hbWUgb2YgdGhlIHJlY2VpdmluZyBvYmplY3QKICBbUkVNT1RFXSA9IGBgOyAvLyBuYW1lIG9mIHRoZSByZW1vdGUgb2JqZWN0CiAgW0hBTkRMRVJTXSA9IHt9OyAvLyB0aGUgbGlzdCBvZiBldmVudCBoYW5kbGVycy4gU2VlIHVwZ3JhZGUoKQoKICAvLyBleHBsaWNpdGx5IGZvcmJpZCB0aGUgY29uc3RydWN0b3IgZnJvbSBiZWluZyB1c2VkLgogIC8vIEB0cy1pZ25vcmU6IHdlIGRvbid0IG5lZWQgdG8gY2FsbCBzdXBlcigpIGlmIHdlIGVycm9yIG91dC4KICBjb25zdHJ1Y3RvcigpIHsKICAgIHRocm93IG5ldyBFcnJvcigKICAgICAgIkNhbm5vdCBjcmVhdGUgVXBncmFkZWRTb2NrZXQgaW5zdGFuY2VzLiBVc2UgVXBncmFkZWRTb2NrZXQudXBncmFkZShuYW1lLCBvcmlnaW4sIHNvY2tldCkgaW5zdGVhZC4iLAogICAgKTsKICB9CgogIC8vIHVwZ3JhZGUgYSBzb2NrZXQgZnJvbSBwbGFpbiBXZWJTb2NrZXQgdG8gdGhpcyBjbGFzcyBpbnN0ZWFkLgogIHN0YXRpYyB1cGdyYWRlKHNvY2tldCwgb3JpZ2luLCByZWNlaXZlciwgcmVtb3RlKSB7CiAgICBpZiAoc29ja2V0IGluc3RhbmNlb2YgVXBncmFkZWRTb2NrZXQpIHJldHVybiBzb2NrZXQ7CiAgICAvLyB1cGRhdGUgdGhlIHByb3RvdHlwZSBiaW5kaW5nCiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc29ja2V0LCBVcGdyYWRlZFNvY2tldC5wcm90b3R5cGUpOwogICAgLy8gbWFrZSBzdXJlIHRoYXQgbWVzc2FnZXMgZ28gdGhyb3VnaCB0aGUgcm91dGVyOgogICAgc29ja2V0W09SSUdJTl0gPSBvcmlnaW47CiAgICBzb2NrZXRbUkVDRUlWRVJdID0gcmVjZWl2ZXI7CiAgICBzb2NrZXRbUkVNT1RFXSA9IHJlbW90ZTsKICAgIHNvY2tldFtIQU5ETEVSU10gPSB7fTsKICAgIGNvbnN0IG1lc3NhZ2VSb3V0ZXIgPSBzb2NrZXQucm91dGVyLmJpbmQoc29ja2V0KTsKICAgIGlmIChzb2NrZXQub24pIHsKICAgICAgc29ja2V0Lm9uKGBtZXNzYWdlYCwgbWVzc2FnZVJvdXRlcik7CiAgICB9IGVsc2UgewogICAgICBzb2NrZXQub25tZXNzYWdlID0gbWVzc2FnZVJvdXRlcjsKICAgIH0KCiAgICAvLyBjb252ZW5pZW5jZSByZXR1cm4uCiAgICByZXR1cm4gc29ja2V0OwogIH0KCiAgLy8gU3BlY2lhbCBhY2Nlc3NvciBmb3IgdXBncmFkZWQgc29ja2V0IGZ1bmN0aW9ucywKICBnZXQgdXBncmFkZWQoKSB7CiAgICBpZiAoIXRoaXMuX191cGdyYWRlZCkgewogICAgICB0aGlzLl9fdXBncmFkZWQgPSB7CiAgICAgICAgb246ICguLi5hcmdzKSA9PiB0aGlzLl9fb24oLi4uYXJncyksCiAgICAgICAgb2ZmOiAoLi4uYXJncykgPT4gdGhpcy5fX29mZiguLi5hcmdzKSwKICAgICAgICBzZW5kOiAoLi4uYXJncykgPT4gdGhpcy5fX3NlbmQoLi4uYXJncyksCiAgICAgIH07CiAgICB9CiAgICByZXR1cm4gdGhpcy5fX3VwZ3JhZGVkOwogIH0KCiAgLy8gbWVzc2FnZSByb3V0ZXIgc3BlY2lmaWNhbGx5IGZvciB0aGUgbWVzc2FnZSBmb3JtYXQgdXNlZCBieSB0aGUgc29ja2V0bGVzcyBjb2RlLgogIGFzeW5jIHJvdXRlcihtZXNzYWdlLCBmb3JjZWQgPSBmYWxzZSkgewogICAgY29uc3QgeyBbT1JJR0lOXTogb3JpZ2luLCBbUkVDRUlWRVJdOiByZWNlaXZlciwgW1JFTU9URV06IHJlbW90ZSB9ID0gdGhpczsKCiAgICAvLyBBbnkgY2FsbHMgZnJvbSB0aGUgYnJvd3NlciB0byB0aGUgd2ViY2xpZW50IGFyZSB0aGF0J3MgYWxyZWFkeSBoYW5kbGVkCiAgICAvLyBieSB0aGUgd2Vic29ja2V0IGRpcmVjdGx5IChzZWUgdGhlIGNyZWF0ZVdlYkNsaWVudCBmdW5jdGlvbiBpbiBpbmRleC5qcywKICAgIC8vIGluIHRoZSB3cy5vbihgY29ubmVjdGlvbmAsIC4uLikgYmxvY2spLCBzbyB3ZSBuZWVkIHRvIG1ha2Ugc3VyZSB0byBub3QKICAgIC8vIHRyeSB0byAiZG91YmxlLWhhbmRsZSIgdGhhdDoKICAgIGlmIChyZW1vdGUgPT09IEJST1dTRVIgJiYgIWZvcmNlZCkgewogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gYnJvd3NlciB3ZWJzb2NrZXQ/IElmIHNvLCB1bndyYXAgdGhlIGRhdGEKICAgIGlmIChtZXNzYWdlLnNyY0VsZW1lbnQpIHsKICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UuZGF0YTsKICAgIH0KCiAgICBsZXQgZGF0YTsKCiAgICB0cnkgewogICAgICBkYXRhID0gSlNPTi5wYXJzZShtZXNzYWdlKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgcmV0dXJuIGNvbnNvbGUuZXJyb3IoYENvdWxkIG5vdCBwYXJzZSB3ZWJzb2NrZXQgZGF0YTogJHttZXNzYWdlfWApOwogICAgfQoKICAgIGNvbnN0IHsgbmFtZTogZXZlbnROYW1lLCBwYXlsb2FkLCBlcnJvcjogZXJyb3JNc2csIGRpZmYsIHNlcV9udW0gfSA9IGRhdGE7CiAgICBsZXQgeyBzdGF0ZSB9ID0gZGF0YTsKICAgIGxldCB0aHJvd2FibGUgPSBlcnJvck1zZyA/IG5ldyBSUENFcnJvcihyZWNlaXZlciwgZXJyb3JNc2cpIDogdW5kZWZpbmVkOwoKICAgIGlmIChERUJVRykKICAgICAgY29uc29sZS5sb2coYFske3JlY2VpdmVyfV0vWyR7cmVtb3RlfV0gcm91dGVyIHJ1bm5pbmcgZ2l2ZW46YCwgewogICAgICAgIGV2ZW50TmFtZSwKICAgICAgICBwYXlsb2FkLAogICAgICAgIGVycm9yTXNnLAogICAgICAgIHN0YXRlLAogICAgICAgIGRpZmYsCiAgICAgICAgc2VxX251bSwKICAgICAgfSk7CgogICAgLy8gQ2xpZW50LXN0YXRlIHN5bmNocm9uaXphdGlvbiBtZWNoYW5pc20gZm9yIHRoZSBicm93c2VyOgogICAgaWYgKHN0YXRlICYmIHJlY2VpdmVyID09PSBCUk9XU0VSKSB7CiAgICAgIGlmIChERUJVRykgY29uc29sZS5sb2coYGhhbmRsaW5nIHN0YXRlIHVwZGF0ZSBpbiB0aGUgYnJvd3NlcmAsIHN0YXRlKTsKICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgb3JpZ2luIG9iamVjdDpgLCB7IG9yaWdpbiB9KTsKICAgICAgY29uc3QgcHJldlN0YXRlID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShvcmlnaW4uc3RhdGUpKTsKICAgICAgaWYgKGRpZmYpIHsKICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUubG9nKGByZWNlaXZlZCBkaWZmYCwgc3RhdGUpOwogICAgICAgIGNvbnN0IHBhdGNoID0gc3RhdGU7CiAgICAgICAgbGV0IHRhcmdldDsKICAgICAgICAvLyB2ZXJpZnkgd2UncmUgc3RpbGwgaW4gc3luYyBieSBjb21wYXJpbmcgbWVzc2FnaW5nIHNlcXVlbmNlIG51bWJlcnMKICAgICAgICBpZiAoc2VxX251bSA9PT0gb3JpZ2luLl9fc2VxX251bSArIDEpIHsKICAgICAgICAgIG9yaWdpbi5fX3NlcV9udW0gPSBzZXFfbnVtOwogICAgICAgICAgdGFyZ2V0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShwcmV2U3RhdGUpKTsKICAgICAgICAgIGlmIChERUJVRykgY29uc29sZS5sb2coYGFwcGx5aW5nIHBhdGNoIHRvYCwgdGFyZ2V0KTsKICAgICAgICAgIC8vIEB0cy1pZ25vcmU6IHRoaXMgb25seSBydW5zIGluIHRoZSBicm93c2VyLCB3aGVyZSByZmM2OTAyIGlzIGEgZ2xvYmFsLgogICAgICAgICAgcmZjNjkwMi5hcHBseVBhdGNoKHRhcmdldCwgcGF0Y2gpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBpZiB3ZSBnZXQgaGVyZSwgd2UncmUgbm90IGluIHN5bmMsIGFuZCB3ZSBuZWVkIHRvIHJlcXVlc3QgYSBmdWxsCiAgICAgICAgICAvLyBzdGF0ZSBvYmplY3QgaW5zdGVhZCBvZiB0cnlpbmcgdG8gYXBwbHkgZGlmZmVyZW50aWFsIHVwZGF0ZXMuCiAgICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUubG9nKGBzZXFfbnVtIG1pc21hdGNoLCBzeW5jaW5nIHN0YXRlYCk7CiAgICAgICAgICBjb25zdCBmdWxsU3RhdGUgPSBhd2FpdCB0aGlzLl9fc2VuZChgc3luY1N0YXRlYCk7CiAgICAgICAgICBvcmlnaW4uX19zZXFfbnVtID0gMDsKICAgICAgICAgIHRhcmdldCA9IGZ1bGxTdGF0ZTsKICAgICAgICB9CiAgICAgICAgc3RhdGUgPSB0YXJnZXQ7CiAgICAgIH0KICAgICAgLy8gUnVuIHRoZSB1cGRhdGUgd2l0aCB0aGUgbmV3IHN0YXRlIGFzIGFyZ3VtZW50IGZpcnN0LCB0aGVuCiAgICAgIC8vIG92ZXJ3cml0ZSB0aGUgb2xkIHN0YXRlIHdpdGggdGhlIG5ldyBzdGF0ZSBhZnRlciB0aGUgdXBkYXRlLgogICAgICBvcmlnaW4uc3RhdGUgPSBzdGF0ZTsKICAgICAgcmV0dXJuIG9yaWdpbi51cGRhdGUocHJldlN0YXRlKTsKICAgIH0KCiAgICAvLyBJZiB0aGlzIGlzIGEgcmVzcG9uc2UgbWVzc2FnZSwgcnVuIHRoZSBgb25gIGhhbmRsZXIgZm9yIHRoYXQuCiAgICBpZiAoZXZlbnROYW1lLmVuZHNXaXRoKFJFU1BPTlNFX1NVRkZJWCkpIHsKICAgICAgY29uc3QgeyBbSEFORExFUlNdOiBoYW5kbGVycyB9ID0gdGhpczsKICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgWyR7cmVjZWl2ZXJ9XSByZXNwb25zZSBtZXNzYWdlIHJlY2VpdmVkYCk7CiAgICAgIGlmICghaGFuZGxlcnNbZXZlbnROYW1lXSkgdGhyb3cgbmV3IEVycm9yKGBubyBoYW5kbGVycyBmb3IgJHtldmVudE5hbWV9YCk7CiAgICAgIGhhbmRsZXJzW2V2ZW50TmFtZV0uZm9yRWFjaCgoaGFuZGxlcikgPT4gewogICAgICAgIGhhbmRsZXIodGhyb3dhYmxlID8gdGhyb3dhYmxlIDogcGF5bG9hZCk7CiAgICAgIH0pOwogICAgICByZXR1cm47CiAgICB9CgogICAgLy8gSWYgd2UgZ2V0IGhlcmUsIHRoaXMgaXMgYSByZWFsIFJQQyBjYWxsIHJhdGhlciB0aGFuIGEgcmVzcG9uc2Ugb3Igc3RhdGUgdXBkYXRlLgogICAgaWYgKHBheWxvYWQgJiYgIUFycmF5LmlzQXJyYXkocGF5bG9hZCkpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKAogICAgICAgIGBbJHtyZWNlaXZlcn1dIHJlY2VpdmVkIHBheWxvYWQgZm9yICR7ZXZlbnROYW1lfSBmcm9tIFske3JlbW90ZX1dIGJ1dCBpdCB3YXMgbm90IGFuIGFycmF5PyAke0pTT04uc3RyaW5naWZ5KAogICAgICAgICAgcGF5bG9hZCwKICAgICAgICAgIG51bGwsCiAgICAgICAgICAyLAogICAgICAgICl9YCwKICAgICAgKTsKICAgIH0KCiAgICAvLyBJZiBpdCdzIGEgcmVxdWVzdCBtZXNzYWdlLCByZXNvbHZlIGl0IHRvIGEgZnVuY3Rpb24gY2FsbCBhbmQgInJldHVybiIKICAgIC8vIHRoZSB2YWx1ZSBieSBzZW5kaW5nIGEgOnJlc3BvbnNlIG1lc3NhZ2Ugb3ZlciB0aGUgd2Vic29ja2V0IGluc3RlYWQuCiAgICBjb25zdCBzdGFnZXMgPSBldmVudE5hbWUuc3BsaXQoYDpgKTsKICAgIGlmIChERUJVRykgY29uc29sZS5sb2coYFske3JlY2VpdmVyfV0gcm91dGVyOiBzdGFnZXM6YCwgc3RhZ2VzKTsKCiAgICBsZXQgY2FsbGFibGUgPSBvcmlnaW47CiAgICBsZXQgZm9yYmlkZGVuID0gb3JpZ2luLl9fcHJvdG9fXz8uY29uc3RydWN0b3IuZGlzYWxsb3dlZENhbGxzID8/IFtdOwogICAgbGV0IGVycm9yID0gdW5kZWZpbmVkOwogICAgbGV0IHJlc3BvbnNlID0gdW5kZWZpbmVkOwoKICAgIC8vIEZpbmQgdGhlIGFjdHVhbCBmdW5jdGlvbiB0byBjYWxsCiAgICB0cnkgewogICAgICBjb25zdCBbZmlyc3RdID0gc3RhZ2VzOwogICAgICBpZiAoc3RhZ2VzLmxlbmd0aCA9PT0gMSAmJiBmb3JiaWRkZW4uaW5jbHVkZXMoZmlyc3QpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbGxlZ2FsIGNhbGw6ICR7Zmlyc3R9IGlzIGEgcHJvdGVjdGVkIG1ldGhvZGApOwogICAgICB9CiAgICAgIHdoaWxlIChzdGFnZXMubGVuZ3RoKSB7CiAgICAgICAgY29uc3Qgc3RhZ2UgPSBzdGFnZXMuc2hpZnQoKTsKICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUubG9nKGBjaGVja2luZyAke3N0YWdlfWApOwogICAgICAgIGNhbGxhYmxlID0gY2FsbGFibGVbc3RhZ2VdOwogICAgICB9CiAgICAgIC8vIElmIHRoaXMgY29kZSBydW5zIG9uIHRoZSBzZXJ2ZXIsIHRoZSBmdW5jdGlvbiBuZWVkcyB0byBiZQogICAgICAvLyBjYWxsZWQgd2l0aCB0aGUgY2xpZW50IHByb3h5IGFzIGZpcnN0IGFyZ3VtZW50LgogICAgICBpZiAocmVjZWl2ZXIgPT09IGBzZXJ2ZXJgKSBwYXlsb2FkLnVuc2hpZnQodGhpc1tQUk9YWV0pOwogICAgfSBjYXRjaCAoZSkgewogICAgICAvLyAiZnVuY3Rpb24gbm90IGZvdW5kIiBkb2Vzbid0IGNvdW50IGFzIGVycm9yICJoZXJlIi4KICAgICAgLy8gSW5zdGVhZCwgd2Ugc2VuZCB0aGF0IGJhY2sgdG8gdGhlIGNhbGxlci4KICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmVycm9yKGBjYW5ub3QgcmVzb2x2ZSAke2V2ZW50TmFtZX0gb24gJHtyZWNlaXZlcn1gLCBlKTsKICAgICAgZXJyb3IgPSBlLm1lc3NhZ2U7CiAgICB9CgogICAgLy8gUmVzb2x2ZSB0aGUgZnVuY3Rpb24gYW5kIHRoZW4gc2VuZCB0aGUgcmVzdWx0IGFzIDpyZXNwb25zZSwgbWFraW5nCiAgICAvLyBzdXJlIHRvIHRha2UgaW50byBhY2NvdW50IHRoYXQgYSBjYWxsIGl0c2VsZiBtaWdodCB0aHJvdy4KICAgIGlmICghZXJyb3IpIHsKICAgICAgdHJ5IHsKICAgICAgICByZXNwb25zZSA9IChhd2FpdCBjYWxsYWJsZS5iaW5kKG9yaWdpbikoLi4ucGF5bG9hZCkpID8/IHRydWU7CiAgICAgICAgLy8gSWYgdGhpcyBpcyBhIHdlYmNsaWVudCwgYW5kIHRoZXJlIGlzIGEgYnJvd3NlciBjb25uZWN0ZWQsCiAgICAgICAgLy8gYWxzbyBtYWtlIHN1cmUgdG8gdHJpZ2dlciBhIHN0YXRlIHN5bmMsIHNvIHRoYXQgY2xpZW50IGNvZGUKICAgICAgICAvLyBkb2VzIG5vdCBuZWVkIHRvIGluY2x1ZGUgc2V0U3RhdGUgY2FsbHMgYWxsIG92ZXIgdGhlIHBsYWNlLgogICAgICAgIGlmIChyZWNlaXZlciA9PT0gQ0xJRU5UICYmIG9yaWdpbi5icm93c2VyKSB7CiAgICAgICAgICBvcmlnaW4uc2V0U3RhdGUob3JpZ2luLnN0YXRlKTsKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICBpZiAoREVCVUcpCiAgICAgICAgICBjb25zb2xlLmVycm9yKAogICAgICAgICAgICBgZnVuY3Rpb24gaW52b2NhdGlvbiBmb3IgJHtldmVudE5hbWV9IGZhaWxlZCBvbiAke3JlY2VpdmVyfSwgcGF5bG9hZDpgLAogICAgICAgICAgICBwYXlsb2FkLAogICAgICAgICAgKTsKICAgICAgICBpZiAoREVCVUcpIGNvbnNvbGUuZXJyb3IoZSk7CiAgICAgICAgZXJyb3IgPSBgQ2Fubm90IGNhbGwgW1ske3JlY2VpdmVyfV1dLiR7ZXZlbnROYW1lLnJlcGxhY2VBbGwoCiAgICAgICAgICBgOmAsCiAgICAgICAgICBgLmAsCiAgICAgICAgKX0sIGZ1bmN0aW9uIGlzIG5vdCBkZWZpbmVkLmA7CiAgICAgIH0KICAgIH0KCiAgICAvLyBTZW5kIG9mZiBhIHJlc3BvbnNlIG1lc3NhZ2Ugd2l0aCBlaXRoZXIgdGhlIHJlc3VsdCwgb3IgdGhlIGVycm9yLgogICAgY29uc3QgcmVzcG9uc2VOYW1lID0gZ2V0UmVzcG9uc2VOYW1lKGV2ZW50TmFtZSk7CiAgICBpZiAoREVCVUcpCiAgICAgIGNvbnNvbGUubG9nKGBbJHtyZWNlaXZlcn1dIHNlbmRpbmcgJHtyZXNwb25zZU5hbWV9YCwgewogICAgICAgIHBheWxvYWQ6IHJlc3BvbnNlLAogICAgICAgIGVycm9yLAogICAgICB9KTsKICAgIHN1cGVyLnNlbmQoCiAgICAgIEpTT04uc3RyaW5naWZ5KHsgbmFtZTogcmVzcG9uc2VOYW1lLCBwYXlsb2FkOiByZXNwb25zZSwgZXJyb3IgfSksCiAgICApOwogIH0KCiAgLyoqCiAgICogdGhpcy51cGdyYWRlZC5vbigpIG1hZGUgdG8gd29yayBsaWtlIC5hZGRFdmVudExpc3RlbmVyKCkKICAgKi8KICBfX29uKGV2ZW50TmFtZSwgaGFuZGxlcikgewogICAgY29uc3QgeyBbSEFORExFUlNdOiBoYW5kbGVycyB9ID0gdGhpczsKICAgIGlmICghaGFuZGxlcnNbZXZlbnROYW1lXSkgaGFuZGxlcnNbZXZlbnROYW1lXSA9IFtdOwogICAgaGFuZGxlcnNbZXZlbnROYW1lXS5wdXNoKGhhbmRsZXIpOwogICAgLy8gcmV0dXJuIHRoZSBjb3JyZXNwb25kaW5nICJvZmYiIGZ1bmN0aW9uLCBmb3IgY29udmVuaWVuY2UuCiAgICByZXR1cm4gKCkgPT4gdGhpcy5fX29mZihldmVudE5hbWUsIGhhbmRsZXIpOwogIH0KCiAgLyoqCiAgICogdGhpcy51cGdyYWRlZC5vZmYoKSBtYWRlIHRvIHdvcmsgbGlrZSAucmVtb3ZlRXZlbnRMaXN0ZW5lcigpCiAgICovCiAgX19vZmYoZXZlbnROYW1lLCBoYW5kbGVyKSB7CiAgICBjb25zdCB7IFtIQU5ETEVSU106IGhhbmRsZXJzIH0gPSB0aGlzOwogICAgaWYgKCFoYW5kbGVyc1tldmVudE5hbWVdKSByZXR1cm47CiAgICBjb25zdCBwb3MgPSBoYW5kbGVyc1tldmVudE5hbWVdLmluZGV4T2YoaGFuZGxlcik7CiAgICBoYW5kbGVyc1tldmVudE5hbWVdLnNwbGljZShwb3MsIDEpOwogIH0KCiAgLyoqCiAgICogQWRkIGEgcHJvbWlzZS1iYXNlZCBlbWl0L3JlY2VpdmUgdG8gdGhlIHNvY2tldCwgc28gdGhhdCBjYWxsaW5nIGNvZGUgY2FuIGBhd2FpdGAgdGhlIHJlc3BvbnNlLgogICAqCiAgICogTm90ZSB0aGF0IHRoZXJlIGlzIGFuIG9wdGlvbmFsIHRoaXJkIGFyZ3VtZW50IGB0aW1lb3V0YCB0aGF0IGNhbiBiZSB1c2VkIHRvIHNheSBob3cgbG9uZyB0aGUKICAgKiBlbWl0IHNob3VsZCB3YWl0IGJlZm9yZSBkZWNpZGluZyB0aGVyZSBpcyBubyByZXNwb25zZSBmb3J0aGNvbWluZyBhbmQgdG8gY2xlYW4gdXAgdGhlIGV2ZW50CiAgICogbGlzdGVuZXIgZm9yIHRoYXQgcmVzcG9uc2UuIFRoZSBkZWZhdWx0IHRpbWVvdXQgaXMgMTAwMG1zLgogICAqLwogIGFzeW5jIF9fc2VuZChldmVudE5hbWUsIGRhdGEgPSB7fSwgdGltZW91dCA9IDEwMDApIHsKICAgIGNvbnN0IHsgW1JFQ0VJVkVSXTogcmVjZWl2ZXIsIFtSRU1PVEVdOiByZW1vdGUgfSA9IHRoaXM7CiAgICBpZiAoREVCVUcpCiAgICAgIGNvbnNvbGUubG9nKGBbJHtyZWNlaXZlcn1dIHNlbmRpbmcgWyR7ZXZlbnROYW1lfV0gdG8gWyR7cmVtb3RlfV06YCwgZGF0YSk7CiAgICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICBjb25zdCByZXNwb25zZU5hbWUgPSBnZXRSZXNwb25zZU5hbWUoZXZlbnROYW1lKTsKCiAgICAgIC8vIGNsZWFudXAgZnVuY3Rpb24gZm9yIHRoZSBldmVudCBsaXN0ZW5lcgogICAgICBsZXQgY2xlYW51cCA9IChkYXRhID0gdW5kZWZpbmVkKSA9PiB7CiAgICAgICAgaWYgKERFQlVHKSBjb25zb2xlLmxvZyhgWyR7cmVjZWl2ZXJ9XSBjbGVhbnVwYCk7CiAgICAgICAgLy8gY2xlYW4gdXAgYW5kIGJlY29tZSBhIG5vb3Agc28gd2UgY2FuJ3QgYmUgcmV0cmlnZ2VyZWQuCiAgICAgICAgdGhpcy5fX29mZihyZXNwb25zZU5hbWUsIGhhbmRsZXIpOwogICAgICAgIGNsZWFudXAgPSAoKSA9PiB7fTsKICAgICAgICByZXNvbHZlKGRhdGEpOwogICAgICB9OwoKICAgICAgLy8gSW4gb3JkZXIgdG8gcmVzb2x2ZSB0aGUgUHJvbWlzZSwgd2Ugd2lsbCBiZSBsaXN0ZW5pbmcKICAgICAgLy8gZm9yIHRoYXQgZXZlbnROYW1lOnJlc3BvbnNlLCBhbmQgd2hlbiB3ZSByZWNlaXZlIGl0LAogICAgICAvLyB3ZSdsbCBpbW1lZGlhdGVseSBTVE9QIGxpc3RlbmluZyBmb3Igc2ltaWxhciByZXNwb25zZXMKICAgICAgLy8gYmVjYXVzZSB3ZSBubyBsb25nZXIgY2FyZS4KICAgICAgY29uc3QgaGFuZGxlciA9IChkYXRhKSA9PiBjbGVhbnVwKGRhdGEpOwoKICAgICAgLy8gRmlyc3QsIG1ha2Ugc3VyZSB3ZSdyZSByZWFkeSB0byByZWNlaXZlIHRoZSByZXNwb25zZS4uLgogICAgICB0aGlzLl9fb24ocmVzcG9uc2VOYW1lLCAoZGF0YSkgPT4gewogICAgICAgIGlmIChERUJVRykKICAgICAgICAgIGNvbnNvbGUubG9nKAogICAgICAgICAgICBgWyR7cmVjZWl2ZXJ9XSBoYW5kbGluZyByZXNwb25zZSBmb3IgJHtldmVudE5hbWV9IGZyb20gWyR7cmVtb3RlfV06YCwKICAgICAgICAgICk7CiAgICAgICAgaGFuZGxlcihkYXRhKTsKICAgICAgfSk7CgogICAgICAvLyBBbmQgdGhlbiwgc2VuZCB0aGUgZXZlbnQgb2ZmIHRvIHRoZSBjbGllbnQuCiAgICAgIGNvbnN0IHNlbmRFdmVudCA9ICgpID0+IHsKICAgICAgICBpZiAoREVCVUcpCiAgICAgICAgICBjb25zb2xlLmxvZygKICAgICAgICAgICAgYChyYXcpIHNlbmRpbmcgJHtldmVudE5hbWV9IGZyb20gJHtyZWNlaXZlcn0gdG8gJHtyZW1vdGV9YCwKICAgICAgICAgICk7CiAgICAgICAgc3VwZXIuc2VuZCgKICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgbmFtZTogZXZlbnROYW1lLAogICAgICAgICAgICBwYXlsb2FkOiBkYXRhLAogICAgICAgICAgfSksCiAgICAgICAgKTsKICAgICAgfTsKCiAgICAgIC8vIFdlIG1heSBiZSB0cnlpbmcgdG8gc2VuZCBiZWZvcmUgdGhlIHNvY2tldCBpcyBvcGVuIGluIGJyb3dzZXIgbGFuZCwKICAgICAgLy8gc28gaWYgdGhlIHNvY2tldCdzIG5vdCByZWFkeSwgInF1ZXVlIiB0aGUgZXZlbnQgdG8gZmlyZSBvbiBvcGVuLgogICAgICBpZiAoc3VwZXIucmVhZHlTdGF0ZSA9PT0gMSkgc2VuZEV2ZW50KCk7CiAgICAgIGVsc2Ugc3VwZXIub25vcGVuID0gc2VuZEV2ZW50OwoKICAgICAgLy8gQW5kIG1ha2Ugc3VyZSB0aGF0IGlmIG5vIHJlc3BvbnNlIGhhcyBvY2N1cnJlZCB3aXRoaW4KICAgICAgLy8gYHRpbWVvdXRgIG1pbGxpc2Vjb25kcywgd2UgY2xlYW4gdXAgdGhlIGxpc3RlbmVyLgogICAgICBpZiAoaXNGaW5pdGUodGltZW91dCkpIHsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IGNsZWFudXAoKSwgdGltZW91dCk7CiAgICAgIH0KICAgIH0pOwogIH0KfQoKLyoqCiAqIEEgc29ja2V0IHByb3h5IGZvciBSUEMgcHVycG9zZXMuCiAqLwpjbGFzcyBTb2NrZXRQcm94eSBleHRlbmRzIEZ1bmN0aW9uIHsKICBjb25zdHJ1Y3Rvcihzb2NrZXQsIHJlY2VpdmVyLCByZW1vdGUsIHBhdGggPSBgYCkgewogICAgc3VwZXIoKTsKICAgIHRoaXNbUkVDRUlWRVJdID0gcmVjZWl2ZXI7CiAgICB0aGlzW1JFTU9URV0gPSByZW1vdGU7CiAgICB0aGlzLmlkID0gdXVpZCgpOwogICAgdGhpcy5wYXRoID0gcGF0aDsKICAgIHRoaXMuc29ja2V0ID0gc29ja2V0OwogICAgcmV0dXJuIG5ldyBQcm94eSh0aGlzLCB7CiAgICAgIGdldDogKF8sIHByb3ApID0+IHsKICAgICAgICBpZiAocHJvcCA9PT0gImlkIikgcmV0dXJuIHRoaXMuaWQ7CiAgICAgICAgaWYgKHByb3AgPT09ICJzb2NrZXQiKSByZXR1cm4gdGhpcy5zb2NrZXQ7CiAgICAgICAgLy8gQHRzLWlnbm9yZTogd2UncmUgbmV2ZXIgaW52b2tpbmcgdGhpcyB3aXRoIFN5bWJvbCBhcyBzZWNvbmQgYXJndW1lbnQKICAgICAgICByZXR1cm4gbmV3IFNvY2tldFByb3h5KHNvY2tldCwgcmVjZWl2ZXIsIHJlbW90ZSwgYCR7cGF0aH06JHtwcm9wfWApOwogICAgICB9LAogICAgICBhcHBseTogYXN5bmMgKF8sIF9fLCBhcmdzKSA9PiB7CiAgICAgICAgaWYgKERFQlVHKQogICAgICAgICAgY29uc29sZS5sb2coCiAgICAgICAgICAgIGBbU1BhcHBseV0gc2VuZGluZyAke3RoaXMucGF0aC5zdWJzdHJpbmcoMSl9IHJlY2VpdmVyICR7CiAgICAgICAgICAgICAgdGhpc1tSRUNFSVZFUl0KICAgICAgICAgICAgfSB0byAke3RoaXNbUkVNT1RFXX1gLAogICAgICAgICAgKTsKCiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuc29ja2V0LnVwZ3JhZGVkLnNlbmQoCiAgICAgICAgICB0aGlzLnBhdGguc3Vic3RyaW5nKDEpLAogICAgICAgICAgYXJncywKICAgICAgICAgIHRoaXNbUkVNT1RFXSA9PT0gQlJPV1NFUiA/IEluZmluaXR5IDogdW5kZWZpbmVkLAogICAgICAgICk7CgogICAgICAgIGlmIChkYXRhIGluc3RhbmNlb2YgUlBDRXJyb3IpIHsKICAgICAgICAgIGNvbnN0IGFyZ3N0ciA9IFsuLi5uZXcgQXJyYXkoYXJncy5sZW5ndGgpXQogICAgICAgICAgICAubWFwKChfLCBpKSA9PiBTdHJpbmcuZnJvbUNoYXJDb2RlKDk3ICsgaSkpCiAgICAgICAgICAgIC5qb2luKGAsYCk7CgogICAgICAgICAgaWYgKERFQlVHKQogICAgICAgICAgICBjb25zb2xlLmVycm9yKAogICAgICAgICAgICAgIGBFUlJPUiBjYWxsaW5nIFtbJHtkYXRhLm9yaWdpbk5hbWV9XV0uJHt0aGlzLnBhdGgKICAgICAgICAgICAgICAgIC5zdWJzdHJpbmcoMSkKICAgICAgICAgICAgICAgIC5yZXBsYWNlQWxsKGA6YCwgYC5gKX0oJHthcmdzdHJ9KTogJHtkYXRhLm1lc3NhZ2V9YCwKICAgICAgICAgICAgKTsKCiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZGF0YS5tZXNzYWdlKTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBkYXRhOwogICAgICB9LAogICAgfSk7CiAgfQp9CgovKioKICogQ3JlYXRlIGEgcHJveGllZCBzb2NrZXQgd2hlcmUgdGhlIGNhbGxlciBsaXRlcmFsbHkgZG9lc24ndCBuZWVkCiAqIHRvIGNhcmUsIHRoZXkganVzdCBuZWVkIHRvIGNhbGwgZnVuY3Rpb25zIGFzIGlmIHRoZXkncmUgbG9jYWxzLgogKgogKiBAcGFyYW0ge3N0cmluZ30gcmVjZWl2ZXIgVGhlIG5hbWUgb2YgdGhlIHJlY2VpdmVyIGZvciB0aGlzIHNvY2tldAogKiBAcGFyYW0ge3N0cmluZ30gcmVtb3RlIFRoZSBuYW1lIG9mIHRoZSByZW1vdGUgZm9yIHRoaXMgc29ja2V0CiAqIEBwYXJhbSB7Kn0gb3JpZ2luIFRoZSBjYWxsaW5nIG9iamVjdCwgdXNlZCBmb3IgdGhpbmdzIGxpa2UgImlsbGVnYWwgZm5hbWVzIiwgc3RhdGUgbWFuYWdlbWVudCwgZXRjLgogKiBAcGFyYW0geyp9IHNvY2tldCBUaGUgc29ja2V0IHdlJ3JlIHdyYXBwaW5nLgogKiBAcmV0dXJucwogKi8KZXhwb3J0IGZ1bmN0aW9uIHByb3h5U29ja2V0KHJlY2VpdmVyLCByZW1vdGUsIG9yaWdpbiwgc29ja2V0KSB7CiAgc29ja2V0ID0gVXBncmFkZWRTb2NrZXQudXBncmFkZShzb2NrZXQsIG9yaWdpbiwgcmVjZWl2ZXIsIHJlbW90ZSk7CiAgcmV0dXJuIChzb2NrZXRbUFJPWFldID0gbmV3IFNvY2tldFByb3h5KHNvY2tldCwgcmVjZWl2ZXIsIHJlbW90ZSkpOwp9CgpleHBvcnQgZnVuY3Rpb24gY3JlYXRlV2ViQ2xpZW50KFdlYkNsaWVudENsYXNzKSB7IGNvbnN0IHNvY2tldCA9IG5ldyBXZWJTb2NrZXQod2luZG93LmxvY2F0aW9uLnRvU3RyaW5nKCkucmVwbGFjZSgiaHR0cCIsICJ3cyIpKTsgY29uc3QgYnJvd3NlckNsaWVudCA9IG5ldyBXZWJDbGllbnRDbGFzcygpOyBPYmplY3QuZGVmaW5lUHJvcGVydHkoYnJvd3NlckNsaWVudCwgInNvY2tldCIsIHsgdmFsdWU6IHNvY2tldCwgd3JpdGFibGU6IGZhbHNlLCBjb25maWd1cmFibGU6IGZhbHNlLCBlbnVtZXJhYmxlOiBmYWxzZSB9KTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KGJyb3dzZXJDbGllbnQsICJzZXJ2ZXIiLCB7IHZhbHVlOiBwcm94eVNvY2tldCgiYnJvd3NlciIsICJ3ZWJjbGllbnQiLCBicm93c2VyQ2xpZW50LCBzb2NrZXQpLCB3cml0YWJsZTogZmFsc2UsIGNvbmZpZ3VyYWJsZTogZmFsc2UsIGVudW1lcmFibGU6IGZhbHNlIH0pOyBPYmplY3QuZGVmaW5lUHJvcGVydHkoYnJvd3NlckNsaWVudCwgInF1aXQiLCB7IHZhbHVlOiAoKSA9PiBicm93c2VyQ2xpZW50LnNlcnZlci5kaXNjb25uZWN0KCkgfSk7IGJyb3dzZXJDbGllbnQuc3RhdGUgPSB7fTsgYnJvd3NlckNsaWVudC5pbml0KCk7IHJldHVybiBicm93c2VyQ2xpZW50OyB9OwooZnVuY3Rpb24ocCxyKXsib2JqZWN0Ij09PXR5cGVvZiBleHBvcnRzJiYidW5kZWZpbmVkIiE9PXR5cGVvZiBtb2R1bGU/cihleHBvcnRzKToiZnVuY3Rpb24iPT09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoWyJleHBvcnRzIl0scik6KHA9InVuZGVmaW5lZCIhPT10eXBlb2YgZ2xvYmFsVGhpcz9nbG9iYWxUaGlzOnB8fHNlbGYscihwLnJmYzY5MDI9e30pKX0pKHRoaXMsZnVuY3Rpb24ocCl7ZnVuY3Rpb24gcihhKXtyZXR1cm4gYS5yZXBsYWNlKC9+MS9nLCIvIikucmVwbGFjZSgvfjAvZywifiIpfWZ1bmN0aW9uIEUoYSl7cmV0dXJuIGEucmVwbGFjZSgvfi9nLCJ+MCIpLnJlcGxhY2UoL1wvL2csIn4xIil9ZnVuY3Rpb24geihhKXtyZXR1cm4gdm9pZCAwPT09YT8idW5kZWZpbmVkIjpudWxsPT09YT8ibnVsbCI6QXJyYXkuaXNBcnJheShhKT8iYXJyYXkiOnR5cGVvZiBhfWZ1bmN0aW9uIHYoYSl7aWYobnVsbD09YXx8Im9iamVjdCIhPXR5cGVvZiBhKXJldHVybiBhOwppZihhLmNvbnN0cnVjdG9yPT1BcnJheSl7dmFyIGI9YS5sZW5ndGgsYz1BcnJheShiKTtmb3IobGV0IGQ9MDtkPGI7ZCsrKWNbZF09dihhW2RdKTtyZXR1cm4gY31pZihhLmNvbnN0cnVjdG9yPT1EYXRlKXJldHVybiBuZXcgRGF0ZSgrYSk7Yj17fTtmb3IoYyBpbiBhKXcuY2FsbChhLGMpJiYoYltjXT12KGFbY10pKTtyZXR1cm4gYn1mdW5jdGlvbiBGKHtvcDphfSl7cmV0dXJuInJlbW92ZSI9PT1hfHwicmVwbGFjZSI9PT1hfHwiY29weSI9PT1hfHwibW92ZSI9PT1hfWZ1bmN0aW9uIEEoYSxiKXtjb25zdCBjPXt9O2Zvcihjb25zdCBkIGluIGEpdy5jYWxsKGEsZCkmJnZvaWQgMCE9PWFbZF0mJihjW2RdPTEpO2Zvcihjb25zdCBkIGluIGIpdy5jYWxsKGIsZCkmJnZvaWQgMCE9PWJbZF0mJmRlbGV0ZSBjW2RdO3JldHVybiBPYmplY3Qua2V5cyhjKX1mdW5jdGlvbiBHKGEpe2NvbnN0IGI9YS5sZW5ndGgsYz17fTtmb3IobGV0IGQ9MDtkPGI7ZCsrKXtjb25zdCBlPWFbZF07Zm9yKGNvbnN0IGYgaW4gZSl3LmNhbGwoZSwKZikmJnZvaWQgMCE9PWVbZl0mJihjW2ZdPShjW2ZdfHwwKSsxKX1mb3IoY29uc3QgZCBpbiBjKWNbZF08YiYmZGVsZXRlIGNbZF07cmV0dXJuIE9iamVjdC5rZXlzKGMpfWZ1bmN0aW9uIHgoYSxiKXtyZXR1cm57b3BlcmF0aW9uczphLm9wZXJhdGlvbnMuY29uY2F0KGIpLGNvc3Q6YS5jb3N0KzF9fWZ1bmN0aW9uIEgoYSxiLGMsZD1xKXtmdW5jdGlvbiBlKGssZyl7Y29uc3QgaD1gJHtrfSwke2d9YDt2YXIgbD1mW2hdO2lmKHZvaWQgMD09PWwpe2lmKDA8ayYmMDxnJiYhZChhW2stMV0sYltnLTFdLGMuYWRkKFN0cmluZyhrLTEpKSkubGVuZ3RoKWw9ZShrLTEsZy0xKTtlbHNle2w9W107aWYoMDxrKXt2YXIgdD1lKGstMSxnKTtsLnB1c2goeCh0LHtvcDoicmVtb3ZlIixpbmRleDprLTF9KSl9MDxnJiYodD1lKGssZy0xKSxsLnB1c2goeCh0LHtvcDoiYWRkIixpbmRleDprLTEsdmFsdWU6YltnLTFdfSkpKTswPGsmJjA8ZyYmKHQ9ZShrLTEsZy0xKSxsLnB1c2goeCh0LHtvcDoicmVwbGFjZSIsCmluZGV4OmstMSxvcmlnaW5hbDphW2stMV0sdmFsdWU6YltnLTFdfSkpKTtsPWwuc29ydCgoSSxKKT0+SS5jb3N0LUouY29zdClbMF19ZltoXT1sfXJldHVybiBsfWNvbnN0IGY9eyIwLDAiOntvcGVyYXRpb25zOltdLGNvc3Q6MH19LEI9aXNOYU4oYS5sZW5ndGgpfHwwPj1hLmxlbmd0aD8wOmEubGVuZ3RoO3ZhciB1PWlzTmFOKGIubGVuZ3RoKXx8MD49Yi5sZW5ndGg/MDpiLmxlbmd0aDt1PWUoQix1KS5vcGVyYXRpb25zO1t1XT11LnJlZHVjZSgoW2ssZ10saCk9PntpZigiYWRkIj09PWgub3Ape3ZhciBsPWguaW5kZXgrMStnO2g9e29wOmgub3AscGF0aDpjLmFkZChsPEIrZz9TdHJpbmcobCk6Ii0iKS50b1N0cmluZygpLHZhbHVlOmgudmFsdWV9O3JldHVybltrLmNvbmNhdChoKSxnKzFdfWlmKCJyZW1vdmUiPT09aC5vcClyZXR1cm4gaD17b3A6aC5vcCxwYXRoOmMuYWRkKFN0cmluZyhoLmluZGV4K2cpKS50b1N0cmluZygpfSxbay5jb25jYXQoaCksZy0xXTtsPWMuYWRkKFN0cmluZyhoLmluZGV4KwpnKSk7aD1kKGgub3JpZ2luYWwsaC52YWx1ZSxsKTtyZXR1cm5bay5jb25jYXQoLi4uaCksZ119LFtbXSwwXSk7cmV0dXJuIHV9ZnVuY3Rpb24gSyhhLGIsYyxkPXEpe2NvbnN0IGU9W107QShhLGIpLmZvckVhY2goZj0+e2UucHVzaCh7b3A6InJlbW92ZSIscGF0aDpjLmFkZChmKS50b1N0cmluZygpfSl9KTtBKGIsYSkuZm9yRWFjaChmPT57ZS5wdXNoKHtvcDoiYWRkIixwYXRoOmMuYWRkKGYpLnRvU3RyaW5nKCksdmFsdWU6YltmXX0pfSk7RyhbYSxiXSkuZm9yRWFjaChmPT57ZS5wdXNoKC4uLmQoYVtmXSxiW2ZdLGMuYWRkKGYpKSl9KTtyZXR1cm4gZX1mdW5jdGlvbiBxKGEsYixjLGQ9cSl7aWYoYT09PWIpcmV0dXJuW107Y29uc3QgZT16KGEpLGY9eihiKTtyZXR1cm4iYXJyYXkiPT1lJiYiYXJyYXkiPT1mP0goYSxiLGMsZCk6Im9iamVjdCI9PWUmJiJvYmplY3QiPT1mP0soYSxiLGMsZCk6W3tvcDoicmVwbGFjZSIscGF0aDpjLnRvU3RyaW5nKCksdmFsdWU6Yn1dfWZ1bmN0aW9uIHkoYSwKYixjKXtBcnJheS5pc0FycmF5KGEpPyItIj09Yj9hLnB1c2goYyk6KGI9cGFyc2VJbnQoYiwxMCksYS5zcGxpY2UoYiwwLGMpKTphW2JdPWN9ZnVuY3Rpb24gQyhhLGIpe0FycmF5LmlzQXJyYXkoYSk/KGI9cGFyc2VJbnQoYiwxMCksYS5zcGxpY2UoYiwxKSk6ZGVsZXRlIGFbYl19ZnVuY3Rpb24gTChhLGIpe2E9bS5mcm9tSlNPTihiLnBhdGgpLmV2YWx1YXRlKGEpO2lmKG51bGw9PT1hLnBhcmVudClyZXR1cm4gbmV3IG4oYi5wYXRoKTtpZihBcnJheS5pc0FycmF5KGEucGFyZW50KSl7aWYocGFyc2VJbnQoYS5rZXksMTApPj1hLnBhcmVudC5sZW5ndGgpcmV0dXJuIG5ldyBuKGIucGF0aCl9ZWxzZSBpZih2b2lkIDA9PT1hLnZhbHVlKXJldHVybiBuZXcgbihiLnBhdGgpO2EucGFyZW50W2Eua2V5XT1iLnZhbHVlO3JldHVybiBudWxsfWZ1bmN0aW9uIE0oYSxiKXtzd2l0Y2goYi5vcCl7Y2FzZSAiYWRkIjpyZXR1cm4gYT1tLmZyb21KU09OKGIucGF0aCkuZXZhbHVhdGUoYSksdm9pZCAwPT09CmEucGFyZW50P2I9bmV3IG4oYi5wYXRoKTooeShhLnBhcmVudCxhLmtleSx2KGIudmFsdWUpKSxiPW51bGwpLGI7Y2FzZSAicmVtb3ZlIjpyZXR1cm4gYT1tLmZyb21KU09OKGIucGF0aCkuZXZhbHVhdGUoYSksdm9pZCAwPT09YS52YWx1ZT9iPW5ldyBuKGIucGF0aCk6KEMoYS5wYXJlbnQsYS5rZXkpLGI9bnVsbCksYjtjYXNlICJyZXBsYWNlIjpyZXR1cm4gTChhLGIpO2Nhc2UgIm1vdmUiOnZhciBjPW0uZnJvbUpTT04oYi5mcm9tKS5ldmFsdWF0ZShhKTt2b2lkIDA9PT1jLnZhbHVlP2I9bmV3IG4oYi5mcm9tKTooYT1tLmZyb21KU09OKGIucGF0aCkuZXZhbHVhdGUoYSksdm9pZCAwPT09YS5wYXJlbnQ/Yj1uZXcgbihiLnBhdGgpOihDKGMucGFyZW50LGMua2V5KSx5KGEucGFyZW50LGEua2V5LGMudmFsdWUpLGI9bnVsbCkpO3JldHVybiBiO2Nhc2UgImNvcHkiOnJldHVybiBjPW0uZnJvbUpTT04oYi5mcm9tKS5ldmFsdWF0ZShhKSx2b2lkIDA9PT1jLnZhbHVlP2I9bmV3IG4oYi5mcm9tKToKKGE9bS5mcm9tSlNPTihiLnBhdGgpLmV2YWx1YXRlKGEpLHZvaWQgMD09PWEucGFyZW50P2I9bmV3IG4oYi5wYXRoKTooeShhLnBhcmVudCxhLmtleSx2KGMudmFsdWUpKSxiPW51bGwpKSxiO2Nhc2UgInRlc3QiOnJldHVybiBhPW0uZnJvbUpTT04oYi5wYXRoKS5ldmFsdWF0ZShhKSxiPXEoYS52YWx1ZSxiLnZhbHVlLG5ldyBtKS5sZW5ndGg/bmV3IE4oYS52YWx1ZSxiLnZhbHVlKTpudWxsLGJ9cmV0dXJuIG5ldyBPKGIpfWZ1bmN0aW9uIFAoYSl7ZnVuY3Rpb24gYihjLGQsZSl7Y29uc3QgZj1hKGMsZCxlKTtyZXR1cm4gQXJyYXkuaXNBcnJheShmKT9mOnEoYyxkLGUsYil9cmV0dXJuIGJ9ZnVuY3Rpb24gRChhLGIpe2E9bS5mcm9tSlNPTihiKS5ldmFsdWF0ZShhKTtpZih2b2lkIDAhPT1hKXJldHVybntvcDoidGVzdCIscGF0aDpiLHZhbHVlOmEudmFsdWV9fWNsYXNzIG17Y29uc3RydWN0b3IoYT1bIiJdKXt0aGlzLnRva2Vucz1hfXN0YXRpYyBmcm9tSlNPTihhKXtjb25zdCBiPQphLnNwbGl0KCIvIikubWFwKHIpO2lmKCIiIT09YlswXSl0aHJvdyBFcnJvcihgSW52YWxpZCBKU09OIFBvaW50ZXI6ICR7YX1gKTtyZXR1cm4gbmV3IG0oYil9dG9TdHJpbmcoKXtyZXR1cm4gdGhpcy50b2tlbnMubWFwKEUpLmpvaW4oIi8iKX1ldmFsdWF0ZShhKXtsZXQgYj1udWxsLGM9IiI7Zm9yKGxldCBkPTEsZT10aGlzLnRva2Vucy5sZW5ndGg7ZDxlO2QrKyliPWEsYz10aGlzLnRva2Vuc1tkXSwiX19wcm90b19fIiE9YyYmImNvbnN0cnVjdG9yIiE9YyYmInByb3RvdHlwZSIhPWMmJihhPShifHx7fSlbY10pO3JldHVybntwYXJlbnQ6YixrZXk6Yyx2YWx1ZTphfX1nZXQoYSl7cmV0dXJuIHRoaXMuZXZhbHVhdGUoYSkudmFsdWV9c2V0KGEsYil7Zm9yKGxldCBjPTEsZD10aGlzLnRva2Vucy5sZW5ndGgtMSxlPXRoaXMudG9rZW5zW2NdO2M8ZDtjKyspYT0oYXx8e30pW2VdO2EmJihhW3RoaXMudG9rZW5zW3RoaXMudG9rZW5zLmxlbmd0aC0xXV09Yil9cHVzaChhKXt0aGlzLnRva2Vucy5wdXNoKGEpfWFkZChhKXthPQp0aGlzLnRva2Vucy5jb25jYXQoU3RyaW5nKGEpKTtyZXR1cm4gbmV3IG0oYSl9fWNvbnN0IHc9T2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtjbGFzcyBuIGV4dGVuZHMgRXJyb3J7Y29uc3RydWN0b3IoYSl7c3VwZXIoYFZhbHVlIHJlcXVpcmVkIGF0IHBhdGg6ICR7YX1gKTt0aGlzLnBhdGg9YTt0aGlzLm5hbWU9Ik1pc3NpbmdFcnJvciJ9fWNsYXNzIE4gZXh0ZW5kcyBFcnJvcntjb25zdHJ1Y3RvcihhLGIpe3N1cGVyKGBUZXN0IGZhaWxlZDogJHthfSAhPSAke2J9YCk7dGhpcy5hY3R1YWw9YTt0aGlzLmV4cGVjdGVkPWI7dGhpcy5uYW1lPSJUZXN0RXJyb3IifX1jbGFzcyBPIGV4dGVuZHMgRXJyb3J7Y29uc3RydWN0b3IoYSl7c3VwZXIoYEludmFsaWQgb3BlcmF0aW9uOiAke2Eub3B9YCk7dGhpcy5vcGVyYXRpb249YTt0aGlzLm5hbWU9IkludmFsaWRPcGVyYXRpb25FcnJvciJ9fXAuYXBwbHlQYXRjaD1mdW5jdGlvbihhLGIpe3JldHVybiBiLm1hcChjPT5NKGEsYykpfTsKcC5jcmVhdGVQYXRjaD1mdW5jdGlvbihhLGIsYyl7Y29uc3QgZD1uZXcgbTtyZXR1cm4oYz9QKGMpOnEpKGEsYixkKX07cC5jcmVhdGVUZXN0cz1mdW5jdGlvbihhLGIpe2NvbnN0IGM9W107Yi5maWx0ZXIoRikuZm9yRWFjaChkPT57Y29uc3QgZT1EKGEsZC5wYXRoKTtlJiZjLnB1c2goZSk7ImZyb20iaW4gZCYmKGQ9RChhLGQuZnJvbSkpJiZjLnB1c2goZCl9KTtyZXR1cm4gY307T2JqZWN0LmRlZmluZVByb3BlcnR5KHAsIl9fZXNNb2R1bGUiLHt2YWx1ZTohMH0pfSk7Cg==");
